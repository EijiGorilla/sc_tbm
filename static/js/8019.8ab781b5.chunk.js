"use strict";(self.webpackChunksc_tbm=self.webpackChunksc_tbm||[]).push([[8019],{37923:(e,t,i)=>{i.d(t,{C:()=>w,b:()=>b});var s,r,o=i(57528),n=i(34981),a=i(26917),l=i(59395),c=i(90080),h=i(54478),d=i(94192),u=i(66763),_=i(80883),p=i(3799),v=i(58350),g=i(64839),m=i(32307),y=i(66470),f=i(91911);function b(e){const t=new m.N5,{vertex:i,fragment:b,attributes:w,varyings:M}=t;(0,p.NB)(i,e),t.include(l.d,e),t.include(h.c,e),t.include(u.A,e),t.include(c.g,e),t.include(a.HQ,e),t.include(f.z,e),w.add(y.r.POSITION,"vec3"),e.vvColor&&w.add(y.r.COLORFEATUREATTRIBUTE,"float"),M.add("vColor","vec4"),M.add("vpos","vec3");const C=e.terrainDepthTest&&e.output===n.V.Color;return C&&M.add("depth","float"),i.uniforms.add(new v.E("eColor",(e=>e.color))),i.main.add((0,g.H)(s||(s=(0,o.A)(["\n      vpos = position;\n      forwardNormalizedVertexColor();\n      forwardObjectAndLayerIdColor();\n\n      ","\n      ","\n      gl_Position = transformPosition(proj, view, vpos);"])),e.hasVertexColors?"vColor *= eColor;":e.vvColor?"vColor = eColor * interpolateVVColor(colorFeatureAttribute);":"vColor = eColor;",C?"depth = (view * vec4(vpos, 1.0)).z;":"")),t.include(a.HQ,e),C&&t.include(d.Z,e),b.include(_.a),b.main.add((0,g.H)(r||(r=(0,o.A)(["\n    discardBySlice(vpos);\n    ","\n    vec4 fColor = vColor;\n    outputColorHighlightOID(fColor, vpos);"])),C?"terrainDepthTest(depth);":"")),t}const w=Object.freeze(Object.defineProperty({__proto__:null,build:b},Symbol.toStringTag,{value:"Module"}))},90806:(e,t,i)=>{i.d(t,{M:()=>v,b:()=>p});var s,r,o,n=i(57528),a=i(90235),l=i(3799),c=i(58350),h=i(21390),d=i(64839),u=i(32307),_=i(66470);function p(e){const t=new u.N5,{vertex:i,fragment:p}=t;(0,l.NB)(i,e),i.uniforms.add(new h.m("width",(e=>e.width))),t.attributes.add(_.r.POSITION,"vec3"),t.attributes.add(_.r.NORMAL,"vec3"),t.attributes.add(_.r.UV0,"vec2"),t.attributes.add(_.r.LENGTH,"float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.main.add((0,d.H)(s||(s=(0,n.A)(["vec3 bitangent = normal;\nvtc = uv0;\nvlength = length;\nvradius = 0.5 * width;\nvec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);\ngl_Position = proj * pos;"])))),p.uniforms.add(new h.m("outlineSize",(e=>e.outlineSize)),new c.E("outlineColor",(e=>e.outlineColor)),new h.m("stripeLength",(e=>e.stripeLength)),new c.E("stripeEvenColor",(e=>e.stripeEvenColor)),new c.E("stripeOddColor",(e=>e.stripeOddColor)));const v=1/Math.sqrt(2);return p.code.add((0,d.H)(r||(r=(0,n.A)(["\n    const float INV_SQRT2 = ",";\n\n    vec4 arrowColor(vec2 tc, float len) {\n      float d = INV_SQRT2 * (tc.x - abs(tc.y));\n      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));\n      d = min(d, 1.0 - abs(tc.y));\n\n      if (d < 0.0) {\n        return vec4(0.0);\n      }\n      if (d < outlineSize) {\n        return outlineColor;\n      }\n      return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;\n    }"])),d.H.float(v))),p.main.add((0,d.H)(o||(o=(0,n.A)(["\n    vec2 ntc = vec2(vtc.x / vradius, vtc.y);\n    vec4 color = arrowColor(ntc, vlength / vradius);\n    if (color.a < ",") {\n      discard;\n    }\n    fragColor = color;"])),d.H.float(a.Q))),t}const v=Object.freeze(Object.defineProperty({__proto__:null,build:p},Symbol.toStringTag,{value:"Module"}))},7137:(e,t,i)=>{i.d(t,{Ow:()=>m,TT:()=>p,Xn:()=>w,Zj:()=>y,_3:()=>b,l1:()=>g,qy:()=>v,vN:()=>f});i(35238);var s=i(50076),r=i(31633),o=i(40565),n=i(63885),a=i(80963),l=i(13312),c=i(23701),h=i(65215);i(19247);function d(e){var t;if(!e)return null;const i=e.wkid;if(i)return n.uw[i];const s=null!==(t=e.wkt2)&&void 0!==t?t:e.wkt;return s?function(e){const t=n._f.exec(e);if(!t||2!==t.length)return null;const i=t[1].split(",");if(!i||i.length<3)return null;const s=parseFloat(i[1]),r=parseFloat(i[2]);return isNaN(s)||isNaN(r)?null:{a:s,f:0===r?0:1/r}}(s):null}function u(e){const t=d(e);if(function(e){return null!=e&&"b"in e&&"eSq"in e&&"radius"in e}(t))return t;const i=t.a*(1-t.f);return Object.assign(t,{b:i,eSq:1-(i/t.a)**2,radius:(2*t.a+i)/3,densificationRatio:1e4/((2*t.a+i)/3)})}function _(e,t,i){const{a:s,eSq:r}=u(i),o=Math.sqrt(r),a=Math.sin(t[1]*n.eh),l=s*t[0]*n.eh;let c;return c=r>0?s*((1-r)*(a/(1-r*(a*a))-1/(2*o)*Math.log((1-o*a)/(1+o*a))))*.5:s*a,e[0]=l,e[1]=c,e}function p(e){return(0,a.EA)(e)&&!!d(e)}function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"square-meters";if(e.some((e=>!p(e.spatialReference))))throw new s.A("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let s=0;s<e.length;s++){const t=e[s],r=t.spatialReference,{radius:o,densificationRatio:n}=u(r),a=o*n;i.push(m(t,a))}const o=[],n=[0,0],a=[0,0];for(let s=0;s<i.length;s++){const{rings:e,spatialReference:l}=i[s];let c=0;for(let t=0;t<e.length;t++){const i=e[t];_(n,i[0],l),_(a,i[i.length-1],l);let s=a[0]*n[1]-n[0]*a[1];for(let e=0;e<i.length-1;e++)_(n,i[e+1],l),_(a,i[e],l),s+=a[0]*n[1]-n[0]*a[1];c+=s}c=(0,r.oU)(c,"square-meters",t),o.push(c/-2)}return o}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"meters";if(!e)throw new s.A("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(e.some((e=>!p(e.spatialReference))))throw new s.A("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let s=0;s<e.length;s++){const o=e[s],{spatialReference:n}=o,a="polyline"===o.type?o.paths:o.rings;let l=0;for(let e=0;e<a.length;e++){const t=a[e];let i=0;for(let e=1;e<t.length;e++){const s=t[e-1][0],r=t[e][0],o=t[e-1][1],a=t[e][1];if(o!==a||s!==r){const e=new y;b(e,[s,o],[r,a],n),i+=e.distance}}l+=i}l=(0,r.oU)(l,"meters",t),i.push(l)}return i}function m(e,t){if("polyline"!==e.type&&"polygon"!==e.type)throw new s.A("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=e;if(!p(i))throw new s.A("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const r="polyline"===e.type?e.paths:e.rings,n=[],a=[0,0],d=new y;for(const s of r){const e=[];n.push(e),e.push([s[0][0],s[0][1]]);let r,o,l=s[0][0],c=s[0][1];for(let n=0;n<s.length-1;n++){if(r=s[n+1][0],o=s[n+1][1],l===r&&c===o)continue;const h=[l,c];b(d,[l,c],[r,o],i);const{azimuth:u,distance:_}=d,p=_/t;if(p>1){for(let s=1;s<=p-1;s++)f(a,h,u,s*t,i),e.push(a.slice());f(a,h,u,(_+Math.floor(p-1)*t)/2,i),e.push(a.slice())}f(a,h,u,_,i),e.push(a.slice()),l=a[0],c=a[1]}}const u=(0,o.PZ)(l.A,i);return"polyline"===e.type?new c.A({paths:n,spatialReference:u}):new h.A({rings:n,spatialReference:u})}class y{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.distance=e,this.azimuth=t,this.reverseAzimuth=i}}function f(e,t,i,s,r){const o=t[0],a=t[1],l=o*n.eh,c=a*n.eh,h=(null!==i&&void 0!==i?i:0)*n.eh,{a:d,b:_,f:p}=u(r),v=Math.sin(h),g=Math.cos(h),m=(1-p)*Math.tan(c),y=1/Math.sqrt(1+m*m),f=m*y,b=Math.atan2(m,g),w=y*v,M=w*w,C=1-M,R=C*(d*d-_*_)/(_*_),O=1+R/16384*(4096+R*(R*(320-175*R)-768)),S=R/1024*(256+R*(R*(74-47*R)-128));let A,P,x,L,T=s/(_*O),E=2*Math.PI;for(;Math.abs(T-E)>1e-12;)x=Math.cos(2*b+T),A=Math.sin(T),P=Math.cos(T),L=S*A*(x+S/4*(P*(2*x*x-1)-S/6*x*(4*A*A-3)*(4*x*x-3))),E=T,T=s/(_*O)+L;const z=f*A-y*P*g,D=Math.atan2(f*P+y*A*g,(1-p)*Math.sqrt(M+z*z)),V=Math.atan2(A*v,y*P-f*A*g),G=p/16*C*(4+p*(4-3*C)),I=D/n.eh,j=(l+(V-(1-G)*p*w*(T+G*A*(x+G*P*(2*x*x-1)))))/n.eh;return e[0]=j,e[1]=I,e}function b(e,t,i,s){const r=t[0]*n.eh,o=t[1]*n.eh,a=i[0]*n.eh,l=i[1]*n.eh,{a:c,b:h,f:d,radius:_}=u(s),p=a-r,v=Math.atan((1-d)*Math.tan(o)),g=Math.atan((1-d)*Math.tan(l)),m=Math.sin(v),y=Math.cos(v),f=Math.sin(g),b=Math.cos(g);let w,M,C,R,O,S,A,P,x,L,T=1e3,E=p;do{if(A=Math.sin(E),P=Math.cos(E),C=Math.sqrt(b*A*(b*A)+(y*f-m*b*P)*(y*f-m*b*P)),0===C)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;O=m*f+y*b*P,S=Math.atan2(C,O),x=y*b*A/C,M=1-x*x,R=O-2*m*f/M,isNaN(R)&&(R=0),L=d/16*M*(4+d*(4-3*M)),w=E,E=p+(1-L)*d*x*(S+L*C*(R+L*O*(2*R*R-1)))}while(Math.abs(E-w)>1e-12&&--T>0);if(0===T){const t=_,i=Math.acos(Math.sin(o)*Math.sin(l)+Math.cos(o)*Math.cos(l)*Math.cos(a-r))*t,s=a-r,c=Math.sin(s)*Math.cos(l),h=Math.cos(o)*Math.sin(l)-Math.sin(o)*Math.cos(l)*Math.cos(s),d=Math.atan2(c,h);return e.azimuth=d/n.eh,e.distance=i,e.reverseAzimuth=void 0,e}const z=M*(c*c-h*h)/(h*h),D=z/1024*(256+z*(z*(74-47*z)-128)),V=h*(1+z/16384*(4096+z*(z*(320-175*z)-768)))*(S-D*C*(R+D/4*(O*(2*R*R-1)-D/6*R*(4*C*C-3)*(4*R*R-3)))),G=Math.atan2(b*Math.sin(E),y*f-m*b*Math.cos(E)),I=Math.atan2(y*Math.sin(E),y*f*Math.cos(E)-m*b);return e.azimuth=G/n.eh,e.distance=V,e.reverseAzimuth=I/n.eh,e}function w(e){return p(e)?e:(0,a.K8)(e)?l.A.WGS84:null}},2522:(e,t,i)=>{i.d(t,{P:()=>l});var s=i(35143),r=i(54901),o=i(91291),n=i(46053),a=(i(81806),i(76460),i(47249),i(85842));const l=e=>{let t=class extends((0,o.g)(e)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(e){this._userInteractive=e}get updating(){return!1}get visible(){return null==this.parent||this.parent.visible&&!this.parent.suspended}set visible(e){this._overrideIfSome("visible",e)}forceInteractiveForViewModel(){return this._interactiveViewModelCount++,(0,r.hA)((()=>this._interactiveViewModelCount--))}};return(0,s._)([(0,n.MZ)({constructOnly:!0})],t.prototype,"parent",void 0),(0,s._)([(0,n.MZ)({constructOnly:!0})],t.prototype,"view",void 0),(0,s._)([(0,n.MZ)({type:Boolean})],t.prototype,"interactive",null),(0,s._)([(0,n.MZ)()],t.prototype,"_userInteractive",void 0),(0,s._)([(0,n.MZ)({readOnly:!0})],t.prototype,"updating",null),(0,s._)([(0,n.MZ)()],t.prototype,"visible",null),(0,s._)([(0,n.MZ)()],t.prototype,"_interactiveViewModelCount",void 0),t=(0,s._)([(0,a.$)("esri.views.3d.analysis.AnalysisView3D")],t),t}},91043:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Le});var s=i(35143),r=i(91967),o=(i(81806),i(30726)),n=i(46053),a=i(76460),l=(i(47249),i(85842)),c=i(16159),h=i(2522),d=i(87562),u=i(68134),_=i(17430),p=i(29772),v=i(23739),g=i(90659);let m=class extends r.A{constructor(e){super(e)}initialize(){this.addHandles([(0,u.wB)((()=>({viewData:this.viewData,startPoint:this.analysis.startPoint})),(e=>{let{viewData:t,startPoint:i}=e;t.elevationAlignedStartPoint=this._applyProjectionAndElevationAlignment(i)}),u.pc),(0,u.wB)((()=>({viewData:this.viewData,endPoint:this.analysis.endPoint})),(e=>{let{viewData:t,endPoint:i}=e;t.elevationAlignedEndPoint=this._applyProjectionAndElevationAlignment(i)}),u.pc),(0,u.wB)((()=>({result:this._computedResult,viewData:this.viewData})),(e=>{let{result:t,viewData:i}=e;i.result=t}),u.pc)])}_applyProjectionAndElevationAlignment(e){if(null==e)return e;const{spatialReference:t,elevationProvider:i}=this.view,s=(0,_.B)(e,t,i);return null!==s&&void 0!==s?s:((0,_.V)(this.analysis,e.spatialReference,a.A.getLogger(this)),null)}get _computedResult(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,measurementMode:i}=this.viewData;if(null==e||null==t)return null;const s=(0,p.NH)(e,t),r=(0,v.Og)(e,t);if(null==s)return null;let o,n;switch(i){case d.G.Auto:n=null!=r?"geodesic":"euclidean",o=null!==r&&void 0!==r?r:s.horizontal;break;case d.G.Geodesic:if(null==r)return null;n="geodesic",o=r;break;case d.G.Euclidean:n="euclidean",o=s.horizontal}return{mode:n,directDistance:s.direct,horizontalDistance:o,verticalDistance:s.vertical,distance:i===d.G.Euclidean||s.horizontal.value<=g.U7?s.direct:null!==r&&void 0!==r?r:s.horizontal}}};(0,s._)([(0,n.MZ)()],m.prototype,"view",void 0),(0,s._)([(0,n.MZ)()],m.prototype,"analysis",void 0),(0,s._)([(0,n.MZ)()],m.prototype,"viewData",void 0),(0,s._)([(0,n.MZ)()],m.prototype,"_computedResult",null),m=(0,s._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController")],m);i(11265);var y=i(59784),f=i(15941),b=i(11113),w=i(24648),M=i(76931),C=i(31633),R=i(19555),O=i(20664),S=i(9392),A=i(57612),P=i(4244),x=i(66747),L=i(7256),T=i(88321),E=i(13191),z=i(43047),D=i(55855),V=i(75762),G=i(32314),I=i(81923),j=i(71372),N=i(62577),Z=i(45463),k=i(48549),F=i(34981),q=i(90235),W=i(59696),H=i(77730),Q=i(66470),B=i(16506),U=i(59246),X=i(60322),Y=i(90806),$=i(93345),J=i(57162);class K extends U.w{constructor(e,t,s){super(e,t,new B.$(Y.M,(()=>i.e(9492).then(i.bind(i,59492)))),s,ee),this.primitiveType=$.WR.TRIANGLE_STRIP}initializePipeline(e){return(0,J.Ey)({blending:e.transparent?(0,X.Yf)(e.oitPass):null,polygonOffset:e.polygonOffsetEnabled?{factor:0,units:-4}:null,depthTest:{func:$.MT.LESS},depthWrite:J.Uy,colorWrite:J.kn})}}const ee=new Map([[Q.r.POSITION,0],[Q.r.NORMAL,1],[Q.r.UV0,2],[Q.r.LENGTH,3]]);var te=i(6485),ie=i(94570);class se extends ie.E{constructor(){super(...arguments),this.polygonOffsetEnabled=!1,this.transparent=!1}}(0,s._)([(0,te.W)()],se.prototype,"polygonOffsetEnabled",void 0),(0,s._)([(0,te.W)()],se.prototype,"transparent",void 0);class re extends Z.im{constructor(e){super(e,ne),this._configuration=new se,this.vertexAttributeLocations=ee,this.produces=new Map([[H.N.OPAQUE_MATERIAL,e=>!this._transparent&&e===F.V.Color],[H.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>this._transparent&&e===F.V.Color]])}getConfiguration(e,t){return this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this._transparent,this._configuration.oitPass=t.oitPass,this._configuration}get visible(){const{outlineColor:e,stripeEvenColor:t,stripeOddColor:i}=this.parameters;return e[3]>=q.Q||t[3]>=q.Q||i[3]>=q.Q}intersect(){}createGLMaterial(e){return new oe(e)}createBufferWriter(){return new _e}get _transparent(){const{parameters:e}=this;return e.outlineColor[3]<1||e.stripeEvenColor[3]<1||e.stripeOddColor[3]<1}}class oe extends W.A{beginSlot(e){return this.acquireTechnique(K,e)}}class ne extends Z.qA{constructor(){super(...arguments),this.width=32,this.outlineSize=.2,this.outlineColor=(0,D.fA)(1,.5,0,1),this.stripeEvenColor=(0,D.fA)(1,1,1,1),this.stripeOddColor=(0,D.fA)(1,.5,0,1),this.stripeLength=1,this.polygonOffset=!1}}const ae=(0,k.BP)().vec3f(Q.r.POSITION).vec3f(Q.r.NORMAL).vec2f(Q.r.UV0).f32(Q.r.LENGTH),le=(0,S.vt)(),ce=(0,S.vt)(),he=(0,S.vt)(),de=(0,S.vt)(),ue=(0,S.vt)();class _e{constructor(){this.vertexBufferLayout=ae}elementCount(e){return 2*(e.get(Q.r.POSITION).indices.length/2+1)}write(e,t,i,s,r,o){const{data:n,indices:a}=i.get(Q.r.POSITION),l=i.get(Q.r.NORMAL).data,c=n.length/3;a&&a.length!==2*(c-1)&&console.warn("MeasurementArrowMaterial does not support indices");const h=le,d=ce,u=he,_=de,p=ue,v=r.position,g=r.normal,m=r.uv0;let y=0;for(let b=0;b<c;++b){const i=3*b;if((0,O.i)(h,n[i],n[i+1],n[i+2]),b<c-1){const e=3*(b+1);(0,O.i)(d,n[e],n[e+1],n[e+2]),(0,O.i)(p,l[e],l[e+1],l[e+2]),(0,O.n)(p,p),(0,O.d)(u,d,h),(0,O.n)(u,u),(0,O.e)(_,p,u),(0,O.n)(_,_)}const s=(0,O.j)(h,d);e&&t&&((0,O.t)(h,h,e),(0,O.t)(d,d,e),(0,O.t)(_,_,t));const r=o+2*b,a=r+1;v.setVec(r,h),v.setVec(a,h),g.setVec(r,_),g.setVec(a,_),m.set(r,0,y),m.set(r,1,-1),m.set(a,0,y),m.set(a,1,1),b<c-1&&(y+=s)}const f=r.length;for(let b=0;b<2*c;++b)f.set(o+b,y)}}class pe extends G.X{constructor(e){super(e),this._arrowWidth=16,this._arrowSubdivisions=128,this._origin=(0,S.vt)(),this._originTransform=(0,E.vt)(),this._arrowCenter=(0,S.vt)(),this._renderOccluded=Z.m$.OccludeAndTransparent,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this._color=(0,D.vt)(),this._contrastColor=(0,D.vt)(),this.applyProperties(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){var t;e!==this._renderOccluded&&(this._renderOccluded=e,null===(t=this._arrowMaterial)||void 0===t||t.setParameters({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){const e=this._stripesEnabled?this._contrastColor:this._color;this._arrowMaterial.setParameters({stripeEvenColor:e})}}get color(){return this._color}set color(e){(0,y.we)(e,this._color)||((0,z.c)(this._color,e),this._updateArrowColor())}get contrastColor(){return this._contrastColor}set contrastColor(e){(0,y.we)(e,this._color)||((0,z.c)(this._contrastColor,e),this._updateArrowColor())}createExternalResources(){const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e;this._arrowMaterial=new re({outlineColor:e,stripeEvenColor:i,stripeOddColor:e,renderOccluded:this.renderOccluded,polygonOffset:!0,isDecoration:this.isDecoration}),this._handles=new T.A,this._handles.add((0,u.wB)((()=>this.view.state.camera),(()=>{this._viewChanged()})))}destroyExternalResources(){this._arrowMaterial=null,this._handles=(0,o.pR)(this._handles)}forEachExternalMaterial(e){e(this._arrowMaterial)}createGeometries(e){var t;if(null==(null===(t=this._geometry)||void 0===t?void 0:t.startRenderSpace)||null==this._geometry.endRenderSpace)return;const i=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);i.transformation=this._originTransform,e.addGeometry(i),this._viewChanged()}_createArrowGeometry(e,t,i,s){const r=this.view,o=r.renderCoordsHelper,n=[],a=[],l=(e,t)=>{const s=V.rq.get();(0,O.d)(s,e,i),n.push(s),a.push(t)};if("euclidean"===s.type){s.eval(.5,this._arrowCenter);const i=V.rq.get();if(o.worldUpAtPosition(this._arrowCenter,i),function(e,t,i){const s=(0,O.a)(ve,t,e),r=(0,O.e)(ve,s,i);return 0===(0,O.G)(r)}(e,t,i)){const{heading:t,tilt:s}=r.camera,{direction:o}=(0,I.ZC)(r,e,t,s,ge);(0,O.c)(i,o)}l(e,i),l(t,i)}else{s.eval(.5,this._arrowCenter);const e=this._arrowSubdivisions+1&-2;for(let t=0;t<e;++t){const i=t/(e-1),r=V.rq.get(),n=V.rq.get();s.eval(i,r),o.worldUpAtPosition(r,n),l(r,n)}}return(0,N.Z8)(this._arrowMaterial,n,a)}_geometryChanged(){this.recreateGeometry()}_viewChanged(){if(this.view.ready&&this.attached&&null!=this._geometry){const e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._arrowWidth*e})}}_updateArrowColor(){if(!this.attached)return;const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e,s=e,r=e;this._arrowMaterial.setParameters({stripeEvenColor:i,outlineColor:s,stripeOddColor:r})}}const ve=(0,S.vt)(),ge=(0,j.NP)();var me=i(47996),ye=i(25191),fe=i(35925),be=i(38042),we=i(63860);let Me=class extends r.A{get _parameters(){const e=this.view.effectiveTheme,{accentColor:t,textColor:i}=e,s=(0,y.QP)(t),r=(0,y.f6)(t,.75),o=(0,y.QP)((0,y.bJ)(t)),n=(0,y.bJ)(i,y.pW.Low);return{accentColor:s,contrastColor:o,translucentAccentColor:r,triangleLineWidth:3,geodesicProjectionLineWidth:2,guideLineWidth:2,guideStippleLengthPixels:3,directLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12,textColor:i,textBackgroundColor:(0,y._L)(n,.6),textCalloutColor:(0,y._L)(n,.5)}}get visible(){return this.analysisView.visible}get viewMode(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView;if(null==e||null==t||e.equals(t))return A.n.None;const i=this.analysisView.result;if(null==i)return A.n.Direct;if("geodesic"===this.actualVisualizedMeasurement)return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?A.n.ProjectedGeodesic:A.n.Direct;const{verticalDistance:s,horizontalDistance:r}=i,o=s.value,n=r.value;return Math.min(o/n,n/o)<this.triangleCollapseRatioThreshold?A.n.Direct:A.n.Triangle}get actualVisualizedMeasurement(){const{measurementMode:e,result:t}=this.analysisView;switch(e){case d.G.Auto:return null!=t&&t.horizontalDistance.value>g.U7?"geodesic":"euclidean";case d.G.Euclidean:return"euclidean";case d.G.Geodesic:return"geodesic"}}get allowVisualElementsOrientationChange(){return null==this._triangleOrientationOverride}set allowVisualElementsOrientationChange(e){null==this._triangleOrientationOverride!==e&&(null==this._triangleOrientationOverride?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}get labels(){return"geodesic"===this.actualVisualizedMeasurement?{direct:null,horizontal:this._segmentLabel,vertical:this._verticalLabel}:{direct:this._segmentLabel,horizontal:this._horizontalLabel,vertical:this._verticalLabel}}constructor(e){super(e),this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=(0,S.vt)(),this._endPosition=(0,S.vt)(),this._cornerPosition=(0,S.vt)(),this._startPositionAtSeaLevel=(0,S.vt)(),this._endPositionAtSeaLevel=(0,S.vt)(),this._triangleOrientationOverride=null,this.messages=null,this.loadingMessages=!0,this.visualElementOrientation=A.f.Auto,this.triangleCollapseRatioThreshold=.03}initialize(){const e=this._parameters,t={attached:!0,view:this.view,isDecoration:!0},{guideLineWidth:i,guideStippleLengthPixels:s,triangleLineWidth:r,geodesicProjectionLineWidth:o,directLabelFontSize:n,verticalLabelFontSize:a,horizontalLabelFontSize:l}=e;this._segmentVisualElement=new pe({...t,geometry:null,renderOccluded:Z.m$.OccludeAndTransparent}),this._triangleVisualElement=new L.t({...t,width:r,renderOccluded:Z.m$.OccludeAndTransparent}),this._rightAngleQuad=new me.n({...t,renderOccluded:Z.m$.OccludeAndTransparent});const c={...t,polygonOffset:!0,renderOccluded:Z.m$.OccludeAndTransparent};this._projectedGeodesicLine=new L.t({...c,width:o,stipplePattern:(0,fe.wk)(s)}),this._geodesicStartHint=new L.t({...c,width:i,stipplePattern:(0,fe.wk)(s)}),this._geodesicEndHint=new L.t({...c,width:i,stipplePattern:(0,fe.wk)(s)}),this._segmentLabel=new x.N({...t,fontSize:n}),this._verticalLabel=new x.N({...t,fontSize:a}),this._horizontalLabel=new x.N({...t,fontSize:l}),this.addHandles([(0,u.wB)((()=>{const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView,i=this.view;return{view:i,camera:i.state.camera,viewMode:this.viewMode,elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,orientation:this._actualVisualElementsOrientation,visualizedMeasurement:this.actualVisualizedMeasurement,stripeLength:this._measurementArrowStripeLength}}),(e=>this._updateGeometryAndViewMode(e)),u.pc),(0,u.wB)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateVisualElementVisibility(e)),u.pc),(0,u.wB)((()=>({text:this._labelsText,visualizedMeasurement:this.actualVisualizedMeasurement})),(e=>this._updateLabelText(e)),u.pc),(0,u.wB)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateLabelVisibility(e)),u.pc),(0,u.wB)((()=>this._measurementArrowStripeLength),(e=>this._updateSegmentStripeLength(e)),u.pc),(0,be.oQ)((async()=>this._updateMessageBundle())),(0,u.wB)((()=>this._parameters),(e=>{let{textBackgroundColor:t,textCalloutColor:i,textColor:s,translucentAccentColor:r,accentColor:o,contrastColor:n}=e;const{_segmentLabel:a,_verticalLabel:l,_horizontalLabel:c,_triangleVisualElement:h,_rightAngleQuad:d,_projectedGeodesicLine:u,_geodesicStartHint:_,_geodesicEndHint:p,_segmentVisualElement:v}=this;a.backgroundColor=t,a.calloutColor=i,a.textColor=s,l.backgroundColor=t,l.calloutColor=i,l.textColor=s,c.backgroundColor=t,c.calloutColor=i,c.textColor=s,h.color=r,d.color=r,u.color=r,_.color=r,p.color=r,v.color=o,v.contrastColor=n}),u.Vh)]),this._updateMessageBundle()}destroy(){this._segmentVisualElement=(0,o.pR)(this._segmentVisualElement),this._triangleVisualElement=(0,o.pR)(this._triangleVisualElement),this._rightAngleQuad=(0,o.pR)(this._rightAngleQuad),this._projectedGeodesicLine=(0,o.pR)(this._projectedGeodesicLine),this._geodesicStartHint=(0,o.pR)(this._geodesicStartHint),this._geodesicEndHint=(0,o.pR)(this._geodesicEndHint),this._segmentLabel=(0,o.pR)(this._segmentLabel),this._verticalLabel=(0,o.pR)(this._verticalLabel),this._horizontalLabel=(0,o.pR)(this._horizontalLabel),this.set("view",null)}_updateVisualElementVisibility(e){let{visible:t,viewMode:i}=e;if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,t)switch(i){case A.n.None:break;case A.n.Direct:this._segmentVisualElement.visible=!0;break;case A.n.Triangle:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case A.n.ProjectedGeodesic:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode(e){let{view:t,camera:i,viewMode:s,elevationAlignedStartPoint:r,elevationAlignedEndPoint:o,orientation:n,visualizedMeasurement:a,stripeLength:l}=e;const c=t.renderCoordsHelper;if(null==c||null==r||null==o||r.equals(o))return;let h=this._startPosition,d=this._endPosition;c.toRenderCoords(r,h),c.toRenderCoords(o,d);const u=n===A.f.AboveSegment?1:-1,_=u*(c.getAltitude(d)-c.getAltitude(h));_<0&&(h=this._endPosition,d=this._startPosition);const p="geodesic"===a?new ye.J(this._startPosition,this._endPosition,c.spatialReference):new ye.C(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=p,this._updateSegmentStripeLength(l),s){case A.n.Direct:this._updateSegment(p,n);break;case A.n.Triangle:this._updateSegmentAndTriangle({view:t,camera:i,segment:p,orientation:n,startPosition:h,endPosition:d,deltaSign:u,altitudeDelta:_});break;case A.n.ProjectedGeodesic:this._updateSegmentAndProjection({view:t,orientation:n,startPosition:h,endPosition:d})}}_updateSegment(e,t){this._segmentLabel.anchor=t===A.f.AboveSegment?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}_updateSegmentAndTriangle(e){let{view:{renderCoordsHelper:t},camera:i,segment:s,orientation:r,startPosition:o,endPosition:n,deltaSign:a,altitudeDelta:l}=e;const c=this._cornerPosition;t.worldUpAtPosition(o,c),(0,O.h)(c,c,a*Math.abs(l)),(0,O.g)(c,c,o),this._triangleVisualElement.geometry=[[[o[0],o[1],o[2]],[c[0],c[1],c[2]],[n[0],n[1],n[2]]]],this._rightAngleQuad.geometry={previous:o,center:c,next:n};const h=new ye.C(o,c),d=new ye.C(c,n),u=function(e,t,i,s,r){const o=Re,n=Oe;r.projectToRenderScreen(i,o),r.projectToRenderScreen(t,n);const a={segment:"bottom",horizontal:"top",vertical:o[0]<n[0]?"left":"right"};{const s=Se,o=Ae;if((0,P.Q)(e,i,r,s),(0,P.Q)(e,t,r,o),(0,R.Om)(s,o)>=Ce){const e=Math.sign(s[1])===Math.sign(o[1]);a.segment=e?(0,x.R)(a.vertical):a.vertical}else{const e=Pe;(0,P.Q)(i,t,r,e),(0,R.Om)(e,o)>=Ce&&(a.segment=Math.sign(e[0])===Math.sign(o[0])?(0,x.R)(a.horizontal):a.horizontal)}}if(s===A.f.BelowSegment){const e=e=>"top"===e?"bottom":"top";a.segment=e(a.segment),a.horizontal=e(a.horizontal),a.vertical=e(a.vertical)}return a}(o,n,c,r,i);this._segmentLabel.anchor=u.segment,this._segmentLabel.geometry={type:"segment",segment:s,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:h,sampleLocation:"center"},this._verticalLabel.anchor=u.vertical,this._horizontalLabel.geometry={type:"segment",segment:d,sampleLocation:"center"},this._horizontalLabel.anchor=u.horizontal}_updateSegmentAndProjection(e){let{view:{renderCoordsHelper:t},orientation:i,startPosition:s,endPosition:r}=e;t.setAltitude(this._startPositionAtSeaLevel,0,s),t.setAltitude(this._endPositionAtSeaLevel,0,r);const o=new ye.J(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(o),this._geodesicStartHint.setGeometryFromSegment(new ye.C(this._startPositionAtSeaLevel,s)),this._geodesicEndHint.setGeometryFromSegment(new ye.C(this._endPositionAtSeaLevel,r)),this._segmentLabel.geometry={type:"segment",segment:o,sampleLocation:"center"},this._segmentLabel.anchor=i===A.f.AboveSegment?"top":"bottom"}_updateLabelText(e){let{text:t,visualizedMeasurement:i}=e;null!=t?(this._segmentLabel.text="euclidean"===i?t.directDistance:t.horizontalDistance,this._horizontalLabel.text=t.horizontalDistance,this._verticalLabel.text=t.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}_updateLabelVisibility(e){let{visible:t,viewMode:i}=e;const s=this._segmentLabel,r=this._horizontalLabel,o=this._verticalLabel;if(s.visible=!1,r.visible=!1,o.visible=!1,t)switch(i){case A.n.Direct:s.visible=!0;break;case A.n.Triangle:s.visible=!0,r.visible=!0,o.visible=!0;break;case A.n.ProjectedGeodesic:s.visible=!0;case A.n.None:}}get _labelsText(){if(this.destroyed)return null;const e=this.messages,t=this.analysisView.result;if(null==t||null==e)return null;const{directDistance:i,horizontalDistance:s,verticalDistance:r}=t,o=this.analysisView.unit,n=e=>({directDistance:"",horizontalDistance:"",verticalDistance:"",...e});switch(o){case"metric":return n({directDistance:i&&(0,b.Ee)(e,i),horizontalDistance:s&&(0,b.Ee)(e,s),verticalDistance:r&&(0,b.W4)(e,r)});case"imperial":return n({directDistance:i&&(0,b.tr)(e,i),horizontalDistance:s&&(0,b.tr)(e,s),verticalDistance:r&&(0,b.t_)(e,r)});default:return n({directDistance:i&&(0,b.zJ)(e,i,o),horizontalDistance:s&&(0,b.zJ)(e,s,o),verticalDistance:r&&(0,b.zJ)(e,r,o)})}}_updateSegmentStripeLength(e){const t=this._segmentVisualElement;null!=e?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}get _actualVisualElementsOrientation(){if(null!=this._triangleOrientationOverride)return this._triangleOrientationOverride;const e=this.visualElementOrientation;return e===A.f.Auto?this.view.state.camera.aboveGround?A.f.AboveSegment:A.f.BelowSegment:e}_requiresGeodesicGuideAt(e){const t=this.view;if(null===t||void 0===t||!t.state)return!1;const i=t.state.camera,s=t.renderCoordsHelper;if(!s)return!1;const r=i.computeScreenPixelSizeAt(e);return s.getAltitude(e)/r>=10}get _measurementArrowStripeLength(){const{result:e,unit:t}=this.analysisView;if(null==e)return null;let i=null;const s=e.directDistance;switch(t){case"metric":i=s&&(0,w.kM)(s,"meters");break;case"imperial":i=s&&(0,w.kM)(s,(0,C.OU)(s.value,s.unit));break;default:i=s&&(0,w.kM)(s,t)}return null==i?null:(0,f.Vr)(i.value/30)*(0,C.oU)(1,i.unit,"meters")}_updateMessageBundle(){this.loadingMessages=!0,(0,we.ud)("esri/core/t9n/Units").then((e=>{this.messages=e})).finally((()=>{this.loadingMessages=!1}))}get testData(){}};(0,s._)([(0,n.MZ)()],Me.prototype,"_parameters",null),(0,s._)([(0,n.MZ)()],Me.prototype,"_triangleOrientationOverride",void 0),(0,s._)([(0,n.MZ)()],Me.prototype,"messages",void 0),(0,s._)([(0,n.MZ)()],Me.prototype,"view",void 0),(0,s._)([(0,n.MZ)()],Me.prototype,"analysis",void 0),(0,s._)([(0,n.MZ)()],Me.prototype,"analysisView",void 0),(0,s._)([(0,n.MZ)()],Me.prototype,"loadingMessages",void 0),(0,s._)([(0,n.MZ)()],Me.prototype,"visible",null),(0,s._)([(0,n.MZ)()],Me.prototype,"viewMode",null),(0,s._)([(0,n.MZ)()],Me.prototype,"actualVisualizedMeasurement",null),(0,s._)([(0,n.MZ)()],Me.prototype,"visualElementOrientation",void 0),(0,s._)([(0,n.MZ)()],Me.prototype,"triangleCollapseRatioThreshold",void 0),(0,s._)([(0,n.MZ)()],Me.prototype,"allowVisualElementsOrientationChange",null),(0,s._)([(0,n.MZ)()],Me.prototype,"labels",null),(0,s._)([(0,n.MZ)()],Me.prototype,"_labelsText",null),(0,s._)([(0,n.MZ)()],Me.prototype,"_actualVisualElementsOrientation",null),(0,s._)([(0,n.MZ)()],Me.prototype,"_measurementArrowStripeLength",null),Me=(0,s._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],Me);const Ce=Math.cos((0,f.kU)(12)),Re=(0,M.r_)(),Oe=(0,M.r_)(),Se=(0,M.QG)(),Ae=(0,M.QG)(),Pe=(0,M.QG)();let xe=class extends((0,h.P)(r.A)){constructor(e){super(e),this.type="direct-line-measurement-view-3d",this.analysis=null,this.result=null,this.measurementMode=d.G.Auto,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}initialize(){const e=this.view,t=this.analysis;this._analysisVisualization=new Me({view:e,analysis:t,analysisView:this}),this._analysisController=new m({view:e,analysis:t,viewData:this})}destroy(){this._analysisController=(0,o.pR)(this._analysisController),this._analysisVisualization=(0,o.pR)(this._analysisVisualization)}get updating(){var e;return!(null===(e=this._analysisVisualization)||void 0===e||!e.loadingMessages)}get viewMode(){return this._analysisVisualization.viewMode}get actualVisualizedMeasurement(){return this._analysisVisualization.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisVisualization.visualElementOrientation}set visualElementOrientation(e){this._analysisVisualization.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisVisualization.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisVisualization.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}get directLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.direct)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get horizontalLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.horizontal)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get verticalLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.vertical)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get unit(){var e;return null!==(e=this.analysis.unit)&&void 0!==e?e:this._defaultUnit}get testData(){}};(0,s._)([(0,n.MZ)()],xe.prototype,"updating",null),(0,s._)([(0,n.MZ)({readOnly:!0})],xe.prototype,"type",void 0),(0,s._)([(0,n.MZ)({constructOnly:!0,nonNullable:!0})],xe.prototype,"analysis",void 0),(0,s._)([(0,n.MZ)()],xe.prototype,"result",void 0),(0,s._)([(0,n.MZ)()],xe.prototype,"measurementMode",void 0),(0,s._)([(0,n.MZ)()],xe.prototype,"elevationAlignedStartPoint",void 0),(0,s._)([(0,n.MZ)()],xe.prototype,"elevationAlignedEndPoint",void 0),(0,s._)([(0,n.MZ)({readOnly:!0})],xe.prototype,"viewMode",null),(0,s._)([(0,n.MZ)({readOnly:!0})],xe.prototype,"actualVisualizedMeasurement",null),(0,s._)([(0,n.MZ)()],xe.prototype,"visualElementOrientation",null),(0,s._)([(0,n.MZ)()],xe.prototype,"allowVisualElementsOrientationChange",null),(0,s._)([(0,n.MZ)()],xe.prototype,"triangleCollapseRatioThreshold",null),(0,s._)([(0,n.MZ)({readOnly:!0})],xe.prototype,"directLabelText",null),(0,s._)([(0,n.MZ)({readOnly:!0})],xe.prototype,"horizontalLabelText",null),(0,s._)([(0,n.MZ)({readOnly:!0})],xe.prototype,"verticalLabelText",null),(0,s._)([(0,n.MZ)()],xe.prototype,"_analysisVisualization",void 0),(0,s._)([(0,n.MZ)()],xe.prototype,"_analysisController",void 0),(0,s._)([(0,n.MZ)()],xe.prototype,"unit",null),(0,s._)([(0,n.MZ)(c.q)],xe.prototype,"_defaultUnit",void 0),xe=(0,s._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],xe);const Le=xe},57612:(e,t,i)=>{var s,r;i.d(t,{f:()=>r,n:()=>s}),function(e){e[e.None=0]="None",e[e.Direct=1]="Direct",e[e.Triangle=2]="Triangle",e[e.ProjectedGeodesic=3]="ProjectedGeodesic"}(s||(s={})),function(e){e[e.Auto=0]="Auto",e[e.AboveSegment=1]="AboveSegment",e[e.BelowSegment=2]="BelowSegment"}(r||(r={}))},87562:(e,t,i)=>{var s;i.d(t,{G:()=>s}),function(e){e[e.Auto=0]="Auto",e[e.Euclidean=1]="Euclidean",e[e.Geodesic=2]="Geodesic"}(s||(s={}))},4244:(e,t,i)=>{i.d(t,{Q:()=>l,X:()=>c});var s=i(76931),r=i(19555),o=i(20664),n=i(9392),a=i(12482);function l(e,t,i,s){i.projectToRenderScreen(e,d),i.projectToRenderScreen(t,u),(0,r.Re)(s,u,d),(0,r.S8)(s,s)}function c(e,t,i,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,n.vt)();const l=(0,o.c)(h,e);return l[2]=(0,a.xS)(s,l,t,i)||0,s.renderCoordsHelper.toRenderCoords(l,t,r),r}const h=(0,n.vt)(),d=(0,s.QG)(),u=(0,s.QG)()},85746:(e,t,i)=>{i.d(t,{X:()=>f});var s=i(35143),r=i(91967),o=i(5632),n=i(46053),a=(i(81806),i(76460),i(47249),i(85842)),l=i(57662),c=i(57824),h=i(44513);class d{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=l.O7.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){var t;this._renderGroup=e;const i=null===(t=this._resources)||void 0===t?void 0:t.layerView;i&&(i.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){var e;this._destroyResources();const t=this._resourceFactory.createResources(),i=new u({view:this._resourceFactory.view,renderGroup:this._renderGroup}),s=null===(e=this._resourceFactory.view.basemapTerrain)||void 0===e?void 0:e.overlayManager;this._resources={layerView:new u({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:t,geometriesAdded:!1},s&&(this._resources.drapeSourceRenderer=s.registerGeometryDrapeSource(i)),this._syncGeometriesToRenderer()}_destroyResources(){var e;if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const t=null===(e=this._resourceFactory.view.basemapTerrain)||void 0===e?void 0:e.overlayManager;t&&t.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,c.q.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,c.q.UPDATE),this._resources.geometriesAdded=!0))}}let u=class extends((0,o.sA)(r.A)){constructor(e){super(e),this.drapeSourceType=l.Om.Features,this.updatePolicy=h.q.SYNC,this.renderGroup=l.O7.Outline}};(0,s._)([(0,n.MZ)({constructOnly:!0})],u.prototype,"view",void 0),(0,s._)([(0,n.MZ)({readOnly:!0})],u.prototype,"drapeSourceType",void 0),(0,s._)([(0,n.MZ)()],u.prototype,"renderGroup",void 0),u=(0,s._)([(0,a.$)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],u);var _=i(69230),p=i(68134),v=i(87634),g=i(37046),m=i(8918);class y{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const t=this._resources.object;this._resources.external.forEach((t=>{t.type!==v.X.Mesh&&t.type!==v.X.Line&&t.type!==v.X.Point||e.remove(t)})),t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer),this._resources.external.forEach((t=>{t.type!==v.X.Mesh&&t.type!==v.X.Line&&t.type!==v.X.Point||e.add(t)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,i=t._stage;if(!i)return;const s=new m.x(i,{pickable:!1,updatePolicy:h.q.SYNC}),r=new g.B({castShadow:!1}),o=e.createResources(r,s);o.forEach((e=>{i.add(e),e.type===v.X.Texture&&e.load(i.renderView.renderingContext)})),i.add(r),s.add(r);const n=e.cameraChanged,a=n?(0,p.wB)((()=>t.state.camera),(e=>n(e)),p.Vh):null;this._resources={layer:s,object:r,external:o,cameraHandle:a},this._syncVisible()}_destroyResources(){var e;if(null==this._resources)return;const t=this._resourceFactory.view._stage;t&&(t.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((e=>{t.remove(e),e.type===v.X.Texture&&e.unload()}))),this._resources.object.dispose(),null!==(e=this._resources.cameraHandle)&&void 0!==e&&e.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class f extends _.B{constructor(e){var t;super(e),this._isDraped=!1,this.object3dResources=new y(this.createObject3DResourceFactory(e.view)),this.drapedResources=new d(this.createDrapedResourceFactory(e.view)),this.isDraped=null!==(t=e.isDraped)&&void 0!==t&&t}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}},66747:(e,t,i)=>{i.d(t,{N:()=>w,R:()=>C});var s=i(69539),r=i(88321),o=i(68134),n=i(76931),a=i(19555),l=i(20664),c=i(9392),h=i(4244),d=i(69230),u=i(35143),_=i(91967),p=i(46053),v=(i(81806),i(76460),i(47249),i(85842)),g=(i(27347),i(10760));i(48396);let m=class extends _.A{get startPosition(){return[this.startX,this.startY]}set startPosition(e){this._set("startX",e[0]),this._set("startY",e[1])}get endPosition(){return[this.endX,this.endY]}set endPosition(e){this._set("endX",e[0]),this._set("endY",e[1])}constructor(e){super(e),this.startX=0,this.startY=0,this.endX=0,this.endY=0,this.width=1,this.color=[0,0,0,.5],this.visible=!0,this.isDecoration=!0}get _strokeStyle(){const e=this.color;return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(e[3],")")}get _lineCap(){return"round"}render(){const{height:e,left:t,top:i,width:s,x1:r,x2:o,y1:n,y2:a}=this._calculateCoordinates(y),l="stroke: ".concat(this._strokeStyle,"; stroke-width: ").concat(this.width,"; stroke-linecap: ").concat(this._lineCap,";");return(0,g.h)("div",{classes:{"esri-line-overlay-item":!0},styles:{left:t+"px",top:i+"px",width:s+"px",height:e+"px",visibility:this.visible?"visible":"hidden"}},[(0,g.h)("svg",{width:s,height:e},[(0,g.h)("line",{x1:r,y1:n,x2:o,y2:a,style:l})])])}renderCanvas(e){if(!this.visible)return;e.strokeStyle=this._strokeStyle,e.lineWidth=this.width,e.lineCap=this._lineCap;const t=this._calculateCoordinates(y);e.beginPath(),e.moveTo(t.left+t.x1,t.top+t.y1),e.lineTo(t.left+t.x2,t.top+t.y2),e.stroke()}_calculateCoordinates(e){const t=Math.min(this.startX,this.endX),i=Math.max(this.startX,this.endX),s=Math.min(this.startY,this.endY),r=Math.max(this.startY,this.endY),o=this.width;return e.left=t-o,e.top=s-o,e.width=i-t+2*o,e.height=Math.max(20,r-s+2*o),e.x1=this.startX-t+o,e.y1=this.startY-s+o,e.x2=this.endX-t+o,e.y2=this.endY-s+o,e}};(0,u._)([(0,p.MZ)()],m.prototype,"startX",void 0),(0,u._)([(0,p.MZ)()],m.prototype,"startY",void 0),(0,u._)([(0,p.MZ)()],m.prototype,"endX",void 0),(0,u._)([(0,p.MZ)()],m.prototype,"endY",void 0),(0,u._)([(0,p.MZ)()],m.prototype,"startPosition",null),(0,u._)([(0,p.MZ)()],m.prototype,"endPosition",null),(0,u._)([(0,p.MZ)()],m.prototype,"width",void 0),(0,u._)([(0,p.MZ)()],m.prototype,"color",void 0),(0,u._)([(0,p.MZ)()],m.prototype,"visible",void 0),(0,u._)([(0,p.MZ)()],m.prototype,"isDecoration",void 0),(0,u._)([(0,p.MZ)({readOnly:!0})],m.prototype,"_strokeStyle",null),m=(0,u._)([(0,v.$)("esri.views.overlay.LineOverlayItem")],m);const y={left:0,top:0,width:0,height:0,x1:0,y1:0,x2:0,y2:0},f=m;var b=i(28048);class w extends d.B{constructor(e){super(e),this._handles=new r.A,this._textItem=null,this._calloutItem=null,this._showCallout=!0,this._showText=!0,this._geometry=null,this._text="-",this._fontSize=14,this._backgroundColor=new s.A([0,0,0,.6]),this._calloutColor=new s.A([0,0,0,.5]),this._textColor=new s.A([255,255,255]),this._distance=25,this._anchor="right",this.updatePositionOnCameraMove=!0,this.applyProperties(e)}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.updateLabelPosition()}get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e,this._textItem&&(this._textItem.isDecoration=e),this._calloutItem&&(this._calloutItem.isDecoration=e)}get textItem(){return this._textItem}get text(){return this._text}set text(e){this._text=e,this.attached&&(this._textItem.text=this._text)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize=e,this.attached&&(this._textItem.fontSize=this._fontSize)}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e,this.attached&&(this._textItem.backgroundColor=this._backgroundColor)}get calloutColor(){return this._calloutColor}set calloutColor(e){this._calloutColor=e,this.attached&&(this._calloutItem.color=this._calloutColor.toRgba())}get textColor(){return this._textColor}set textColor(e){this._textColor=e,this.attached&&(this._textItem.textColor=this._textColor)}get distance(){return this._distance}set distance(e){this._distance!==e&&(this._distance=e,this.updateLabelPosition())}get anchor(){return this._anchor}set anchor(e){this._anchor!==e&&(this._anchor=e,this.updateLabelPosition())}get _camera(){return this.view.state.cssCamera}overlaps(e){var t;return!!this.attached&&this.textItem.visible&&e.textItem.visible&&!(null===(t=this.view.overlay)||void 0===t||!t.overlaps(this._textItem,e.textItem))}updateLabelPosition(){if(!this.attached)return;this._showText=!1,this._showCallout=!1;const{geometry:e,view:t,visible:i}=this;if(null!=e&&t._stage)switch(e.type){case"point":if(!this._computeLabelPositionFromPoint(e.point,z))break;if(e.callout){const t=this._camera,i=e.callout.distance;(0,a.WQ)(E,E,[0,e.callout.offset]),t.renderToScreen(E,z),(0,a.hZ)(x,0,1),(0,a.hs)(x,x,i),(0,a.WQ)(x,x,E),t.renderToScreen(x,D),this._showCallout=this._updatePosition(z,D)}else this._textItem.position=[z[0],z[1]],this._textItem.anchor="center";this._showText=!0;break;case"corner":if(!this._computeLabelPositionFromCorner(e,this._distance,z,D))break;this._showCallout=this._updatePosition(z,D),this._showText=!0;break;case"segment":{if(!this._computeLabelPositionFromSegment(e,this._distance,this._anchor,z,D))break;this._showText=!0;const t=this._updatePosition(z,D);this._showCallout=!1!==e.callout&&t,this._showCallout||(this._textItem.anchor="center")}}this.updateVisibility(i)}_computeLabelPositionFromPoint(e,t){const i=this._camera;return i.projectToRenderScreen(e,T),!(T[2]<0||T[2]>1)&&(i.renderToScreen(T,t),!0)}_computeLabelPositionFromCorner(e,t,i,s){if(!e)return!1;const r=this._camera;return M(e.left,1,r,A),(0,a.ze)(A,A),M(e.right,0,r,P),(0,a.WQ)(x,A,P),(0,a.ze)(x,x),(0,a.S8)(x,x),r.projectToRenderScreen(e.left.endRenderSpace,T),!(T[2]<0||T[2]>1)&&(r.renderToScreen(T,i),(0,a.hs)(x,x,t),(0,a.WQ)(x,x,T),r.renderToScreen(x,s),!0)}_computeLabelPositionFromSegment(e,t,i,s,r){if(!e)return!1;const o=e.segment,n=this._camera;(0,h.Q)(o.startRenderSpace,o.endRenderSpace,n,A),(0,a.hZ)(x,-A[1],A[0]);let l=!1;switch(i){case"top":l=x[1]<0;break;case"bottom":l=x[1]>0;break;case"left":l=x[0]>0;break;case"right":l=x[0]<0}if(l&&(0,a.ze)(x,x),0===(0,a.Bw)(x))switch(i){case"top":x[1]=1;break;case"bottom":x[1]=-1;break;case"left":x[0]=-1;break;case"right":x[0]=1}return o.eval(V[e.sampleLocation],L),n.projectToRenderScreen(L,T),!(T[2]<0||T[2]>1)&&(n.renderToScreen(T,s),(0,a.hs)(x,x,t),(0,a.WQ)(x,x,T),n.renderToScreen(x,r),!0)}_updatePosition(e,t){if(t){const i=t[0]-e[0],s=t[1]-e[1];return this._textItem.position=[t[0],t[1]],this._textItem.anchor=Math.abs(i)>Math.abs(s)?i>0?"left":"right":s>0?"top":"bottom",this._calloutItem.startPosition=[e[0],e[1]],this._calloutItem.endPosition=[t[0],t[1]],!0}return this._textItem.position=[e[0],e[1]],this._textItem.anchor="center",!1}createResources(){var e;this._textItem=new b.A({visible:!0,text:this._text,fontSize:this._fontSize,backgroundColor:this._backgroundColor,textColor:this._textColor,isDecoration:this._isDecoration}),this._calloutItem=new f({color:this._calloutColor.toRgba(),visible:!0,width:2,isDecoration:this._isDecoration}),this.updateLabelPosition(),null!==(e=this.view.overlay)&&void 0!==e&&e.items.addMany([this._textItem,this._calloutItem]),this.updatePositionOnCameraMove&&this._handles.add((0,o.wB)((()=>this.view.state.camera),(()=>this.updateLabelPosition())))}destroyResources(){this.view.overlay&&!this.view.overlay.destroyed&&this.view.overlay.items.removeMany([this._textItem,this._calloutItem]),this._handles.removeAll()}updateVisibility(e){this._textItem.visible=this._showText&&e,this._calloutItem.visible=this._showCallout&&e}}function M(e,t,i,s){return e.eval(t,R,S),(0,l.g)(O,R,S),(0,h.Q)(R,O,i,s)}function C(e){switch(e){case"top":return"bottom";case"right":return"left";case"bottom":return"top";case"left":return"right"}}const R=(0,c.vt)(),O=(0,c.vt)(),S=(0,c.vt)(),A=(0,n.QG)(),P=(0,n.QG)(),x=(0,n.QG)(),L=(0,c.vt)(),T=(0,n.r_)(),E=(0,n.QG)(),z=(0,n.gs)(),D=(0,n.gs)(),V={start:0,center:.5,end:1}},32314:(e,t,i)=>{i.d(t,{X:()=>c});var s=i(34761),r=i(13191),o=i(69230),n=i(37046),a=i(44513),l=i(8918);class c extends o.B{constructor(e){super(e),this._resources=null,this._transform=(0,r.vt)()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(e){(0,s.C)(this._transform,e),null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null==this._resources)return;const e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,t.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const t=new l.x(e,{pickable:!1,updatePolicy:a.q.SYNC}),i=new n.B({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((t=>e.add(t))),e.add(i),t.add(i),i.visible=this.visible,this._resources={layer:t,object:i}}destroyResources(){const e=this.view._stage;null!=this._resources&&e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial((t=>{e.remove(t)})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){null!=this._resources&&(this._resources.object.visible=e)}}},47996:(e,t,i)=>{i.d(t,{n:()=>M});var s=i(68134),r=i(34761),o=i(13191),n=i(20664),a=i(9392),l=i(43047),c=i(55855),h=i(75762),d=i(18117),u=i(85746),_=i(33169),p=i(50468),v=i(17345),g=i(62577),m=i(45463),y=i(442),f=i(66470),b=i(76956),w=i(425);class M extends u.X{constructor(e){super(e),this._maxSize=0,this._position=(0,a.vt)(),this._up=(0,a.vt)(),this._right=(0,a.vt)(),this._renderOccluded=m.m$.OccludeAndTransparent,this._color=(0,c.fA)(1,0,0,1),this._outlineColor=(0,c.fA)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=m.m$.Opaque,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:C}}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){(0,l.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,l.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry(e){let{previous:t,center:i,next:s}=e;this._maxSize=Math.min((0,n.j)(i,t),(0,n.j)(i,s))/3,(0,n.n)(this._up,(0,n.d)(this._up,t,i)),(0,n.n)(this._right,(0,n.d)(this._right,s,i)),(0,n.c)(this._position,i),this.recreateGeometry()}_createObject3DResources(e){const t=new b.v(this._quadMaterialParameters),i=0===this._outlineSize?void 0:new w.W(this._outlineMaterialParameters);return this._createObject3DGeometries(e,t,i),{quadMaterial:t,outlineMaterial:i,forEach:e=>{e(t),i&&e(i)}}}_createObject3DGeometries(e,t,i){if((0,n.p)(this._up,a.uY)&&(0,n.p)(this._right,a.uY))return;const s=this._createGeometries(t,i);for(const r of s)e.addGeometry(r);this._updateTransformObject3D(e)}_createDrapedResources(){const e=new b.v(this._quadMaterialParameters),t=0===this._outlineSize?void 0:new w.W(this._outlineMaterialParameters),i=this._createGeometries(e,t).map((e=>new y.$(e)));return this._setTransformDraped(i),{quadMaterial:e,outlineMaterial:t,geometries:i,pixelRatioHandle:(0,s.wB)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}))}}_createGeometries(e,t){const{up:i,right:s,corner:r}=this._getVertices(),o=function(e,t,i,s){return new v.V(s,[[f.r.POSITION,new p.n([0,0,0,...t,...e,...i],[0,1,2,1,2,3],3,!0)]])}(i,s,r,e);return t?[o,(0,g.Z8)(t,[i,r,s])]:[o]}_getVertices(){let e=this._up,t=this._right;const i=(0,n.g)(h.rq.get(),e,t);return this.isDraped&&(e=(0,n.c)(h.rq.get(),e),t=(0,n.c)(h.rq.get(),t),e[2]=0,t[2]=0,i[2]=0),{up:e,right:t,corner:i}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.object3dResources.object;if(!e)return;const t=this.view.state.camera,i=this._size*t.computeScreenPixelSizeAt(this._position),s=Math.min(this._maxSize,i);(0,r.kN)(R,this._position),(0,r.hs)(R,R,[s,s,s]),e.transformation=R}_setTransformDraped(e){if(0===e.length)return;const{view:{basemapTerrain:{overlayManager:t},state:{contentPixelRatio:i}}}=this,{_position:s,_size:o}=this,a=(0,n.c)(h.rq.get(),s);a[2]=_.bi;const l=O;l.spatialReference=t.renderer.spatialReference,l.x=a[0],l.y=a[1];const c=o*(this.view.overlayPixelSizeInMapUnits(l)*i),d=Math.min(this._maxSize,c);(0,r.kN)(R,a),(0,r.hs)(R,R,[d,d,1]);for(const r of e)r.transformation=R}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){var e,t;null!==(e=this.object3dResources.resources)&&void 0!==e&&e.quadMaterial.setParameters(this._quadMaterialParameters),null===(t=this.drapedResources.resources)||void 0===t||t.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){var e,t;null!==(e=this.object3dResources.resources)&&void 0!==e&&null!==(e=e.outlineMaterial)&&void 0!==e&&e.setParameters(this._outlineMaterialParameters),null===(t=this.drapedResources.resources)||void 0===t||null===(t=t.outlineMaterial)||void 0===t||t.setParameters(this._outlineMaterialParameters)}}function C(e){e.pixelRatioHandle.remove(),e.geometries=[]}const R=(0,o.vt)(),O=(0,d.T)(0,0,void 0,null)},69230:(e,t,i)=>{i.d(t,{B:()=>r});i(81806);var s=i(68134);class r{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(e){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e.view,this._handle=(0,s.wB)((()=>e.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProperties(e){let t=!1;for(const i in e)i in this&&("attached"===i?t=!!e[i]:this[i]=e[i]);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},25191:(e,t,i)=>{i.d(t,{C:()=>h,J:()=>d});var s=i(20664),r=i(9392),o=i(9624),n=i(98510),a=i(14487),l=i(75762),c=i(94966);class h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.vt)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,r.vt)();this.startRenderSpace=e,this.endRenderSpace=t,this.type="euclidean"}eval(e,t,i){return(0,s.m)(t,this.startRenderSpace,this.endRenderSpace,e),i&&((0,s.d)(i,this.endRenderSpace,this.startRenderSpace),(0,s.n)(i,i)),t}createRenderGeometry(e,t){const i=[],r=[],o=(t,o)=>{const n=_;(0,s.d)(n,t,e),i.push([n[0],n[1],n[2]]),r.push([o[0],o[1],o[2]])},n=t.worldUpAtPosition(this.eval(.5,u),l.rq.get());return o(this.startRenderSpace,n),o(this.endRenderSpace,n),{points:i,normals:r}}static fromPositionAndVector(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,s.h)(u,t,i),(0,s.g)(u,e,u),new h((0,r.o8)(e),(0,r.o8)(u))}}class d{_projectIn(e,t){this._project?(0,a.F)(e,this.renderSpatialReference,t,this._pcpf):(0,s.c)(t,e)}constructor(e,t,i){this.startRenderSpace=e,this.endRenderSpace=t,this.renderSpatialReference=i,this.type="geodesic",this._start=(0,r.vt)(),this._end=(0,r.vt)(),this._pcpf=(0,n.lO)(i),this._project=(0,o.canProjectWithoutEngine)(i,this._pcpf),this._projectIn(e,this._start),this._projectIn(t,this._end)}eval(e,t,i){if(this._project)if(i){const r=_;(0,c.is)(this._start,this._end,e,t,r),(0,s.g)(p,t,r),(0,a.F)(t,this._pcpf,t,this.renderSpatialReference),(0,a.F)(p,this._pcpf,p,this.renderSpatialReference),(0,s.d)(i,p,t),(0,s.n)(i,i)}else(0,c.nu)(this._start,this._end,e,t),(0,a.F)(t,this._pcpf,t,this.renderSpatialReference);else(0,s.m)(t,this._start,this._end,e),i&&((0,s.d)(i,this._end,this._start),(0,s.n)(i,i));return t}createRenderGeometry(e,t){const i=[],r=[],o=(t,o)=>{const n=p;(0,s.d)(n,t,e),i.push([n[0],n[1],n[2]]),r.push([o[0],o[1],o[2]])};for(let s=0;s<128;++s){const e=s/127,i=u,r=_;this.eval(e,i),t.worldUpAtPosition(i,r),o(i,r)}return{points:i,normals:r}}}const u=(0,r.vt)(),_=(0,r.vt)(),p=(0,r.vt)()},76956:(e,t,i)=>{i.d(t,{v:()=>T});var s=i(55855),r=i(48549),o=i(34981),n=i(90235),a=i(61785),l=i(83490),c=i(59696),h=i(60322),d=i(77730),u=i(66470),_=i(82809),p=i(63928),v=i(93684),g=i(16506),m=i(59246),y=i(72001),f=i(96643),b=i(37923),w=i(93345),M=i(57162);v.S;class C extends m.w{constructor(e,t,s){super(e,t,new g.$(b.C,(()=>i.e(5837).then(i.bind(i,35837)))),s)}_createPipeline(e,t){const{oitPass:i,output:s,transparent:r,cullFace:n,draped:a,hasOccludees:l,polygonOffset:c,enableOffset:d}=e,u=i===y.Y.NONE,_=i===y.Y.FrontFace;return(0,M.Ey)({blending:s===o.V.Color&&r?(0,h.Yf)(i):null,culling:(0,M.Xt)(n),depthTest:a?null:{func:(0,h.K_)(i)},depthWrite:(0,h.z5)(e),drawBuffers:s===o.V.Depth?{buffers:[w.Hr.NONE]}:(0,h.m6)(i,s),colorWrite:M.kn,stencilWrite:l?f.v0:null,stencilTest:l?t?f.a9:f.qh:null,polygonOffset:u||_?c?R:null:(0,h.aB)(d)})}initializePipeline(e){return this._occludeePipelineState=this._createPipeline(e,!0),this._createPipeline(e,!1)}getPipeline(e){return e?this._occludeePipelineState:super.getPipeline()}}const R={factor:1,units:1};var O=i(35143),S=i(97808),A=i(42717),P=i(6485),x=i(94570);class L extends x.E{constructor(){super(...arguments),this.cullFace=l.s2.None,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.discardInvisibleFragments=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.objectAndLayerIdColorInstanced=!1,this.vvColor=!1,this.draped=!1,this.textureCoordinateType=S.I.None,this.emissionSource=A.ZX.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.vvSize=!1,this.vvOpacity=!1}}(0,O._)([(0,P.W)({count:l.s2.COUNT})],L.prototype,"cullFace",void 0),(0,O._)([(0,P.W)()],L.prototype,"hasSlicePlane",void 0),(0,O._)([(0,P.W)()],L.prototype,"hasVertexColors",void 0),(0,O._)([(0,P.W)()],L.prototype,"transparent",void 0),(0,O._)([(0,P.W)()],L.prototype,"discardInvisibleFragments",void 0),(0,O._)([(0,P.W)()],L.prototype,"polygonOffset",void 0),(0,O._)([(0,P.W)()],L.prototype,"enableOffset",void 0),(0,O._)([(0,P.W)()],L.prototype,"writeDepth",void 0),(0,O._)([(0,P.W)()],L.prototype,"hasOccludees",void 0),(0,O._)([(0,P.W)()],L.prototype,"terrainDepthTest",void 0),(0,O._)([(0,P.W)()],L.prototype,"cullAboveTerrain",void 0),(0,O._)([(0,P.W)()],L.prototype,"objectAndLayerIdColorInstanced",void 0),(0,O._)([(0,P.W)()],L.prototype,"vvColor",void 0),(0,O._)([(0,P.W)()],L.prototype,"draped",void 0);class T extends p.W{constructor(e){super(e,z),this._configuration=new L,this.supportsEdges=!0,this.produces=new Map([[d.N.OPAQUE_MATERIAL,e=>this._isOpaqueMaterialPass(e)],[d.N.OPAQUE_MATERIAL_WITHOUT_NORMALS,e=>this._isOpaqueNoSSAODepthPass(e)],[d.N.TRANSPARENT_MATERIAL,e=>(0,o.zW)(e)&&this._transparent&&this.parameters.writeDepth],[d.N.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,e=>(0,o.eh)(e)&&this._transparent&&this.parameters.writeDepth],[d.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>(0,o.zW)(e)&&this._transparent&&!this.parameters.writeDepth],[d.N.DRAPED_MATERIAL,e=>(0,o.i3)(e)]])}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this._transparent,this._configuration.discardInvisibleFragments=this._transparent&&!this._isOpaquePass(e)&&this.parameters.discardInvisibleFragments,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=t.hasOccludees,this._configuration.oitPass=t.oitPass,this._configuration.enableOffset=t.camera.relativeElevation<h.xt,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.draped=this.parameters.draped,this._configuration}get visible(){return this.parameters.color[3]>=n.Q}get _transparent(){return this.parameters.color[3]<1||this.parameters.forceTransparentMode}_isOpaquePass(e){return this._isOpaqueMaterialPass(e)||this._isOpaqueNoSSAODepthPass(e)}_isOpaqueMaterialPass(e){return e===o.V.Highlight||(0,o.zW)(e)&&!this._transparent}_isOpaqueNoSSAODepthPass(e){return(0,o.eh)(e)&&this.parameters.writeDepth&&!this._transparent}createGLMaterial(e){return new E(e)}createBufferWriter(){const e=(0,r.BP)().vec3f(u.r.POSITION);return(0,a.E)()&&e.vec4u8(u.r.OBJECTANDLAYERIDCOLOR),this.parameters.vvColor?e.f32(u.r.COLORFEATUREATTRIBUTE):e.vec4u8(u.r.COLOR),new _.Z(e)}}class E extends c.A{beginSlot(e){return this.acquireTechnique(C,e)}}class z extends v.S{constructor(){super(...arguments),this.color=s.uY,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=l.s2.None,this.draped=!1,this.discardInvisibleFragments=!1}}},63928:(e,t,i)=>{i.d(t,{W:()=>o});var s=i(45463),r=i(48168);class o extends s.im{intersect(e,t,i,s,o,n){return(0,r.Uy)(e,i,s,o,void 0,n)}}}}]);
//# sourceMappingURL=8019.8ab781b5.chunk.js.map